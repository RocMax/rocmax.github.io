<!DOCTYPE html>
<html lang="zh"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>霍夫曼编码 - Roc's Blog</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://blog.game18.net/posts/2016/05/huo-fu-man-bian-ma/">

        <meta name="author" content="Roc" />
        <meta name="keywords" content="Huffman,千里码" />
        <meta name="description" content="千里码遇到霍夫曼编码问题，做个总结。" />

        <meta property="og:site_name" content="Roc's Blog" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="霍夫曼编码"/>
        <meta property="og:url" content="http://blog.game18.net/posts/2016/05/huo-fu-man-bian-ma/"/>
        <meta property="og:description" content="千里码遇到霍夫曼编码问题，做个总结。"/>
        <meta property="article:published_time" content="2016-05-23" />
            <meta property="article:section" content="Python" />
            <meta property="article:tag" content="Huffman" />
            <meta property="article:tag" content="千里码" />
            <meta property="article:author" content="Roc" />

    <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@ROCLEE">
        <meta name="twitter:creator" content="@ROCLEE">
    <meta name="twitter:domain" content="http://blog.game18.net">

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://blog.game18.net/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://blog.game18.net/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://blog.game18.net/theme/css/pygments/monokai.css" rel="stylesheet">
    <link href="http://blog.game18.net/theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="http://blog.game18.net/theme/css/style.css" type="text/css"/>
        <link href="http://blog.game18.net/theme/css/shariff/shariff.min.css" rel="stylesheet">

        <link href="http://blog.game18.net/feed/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Roc's Blog ATOM Feed"/>
        <link href="http://blog.game18.net/feed/all.rss.xml" type="application/rss+xml" rel="alternate"
              title="Roc's Blog RSS Feed"/>

</head>
<body>

<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://blog.game18.net/" class="navbar-brand">
Roc's Blog            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li >
                            <a href="http://blog.game18.net/category/cocos2d-x">Cocos2d-x</a>
                        </li>
                        <li class="active">
                            <a href="http://blog.game18.net/category/python">Python</a>
                        </li>
                        <li >
                            <a href="http://blog.game18.net/category/sui-bi">随笔</a>
                        </li>
                        <li >
                            <a href="http://blog.game18.net/category/wang-ye-ji-zhu">网页技术</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><span>
                <form class="navbar-search" action="/search">
                  <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
              </li>
              <li><a href="http://blog.game18.net/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
            <ol class="breadcrumb">
                <li><a href="http://blog.game18.net" title="Roc's Blog"><i class="fa fa-home fa-lg"></i></a></li>
                <li><a href="http://blog.game18.net/category/python" title="Python">Python</a></li>
                <li class="active">霍夫曼编码</li>
            </ol>

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://blog.game18.net/posts/2016/05/huo-fu-man-bian-ma/"
                       rel="bookmark"
                       title="Permalink to 霍夫曼编码">
                        霍夫曼编码
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2016-05-23T14:19:57+08:00"> 2016-05-23(一)</time>
    </span>



<span class="label label-default">Tags</span>
	<a href="http://blog.game18.net/tag/huffman/">Huffman</a>
        /
	<a href="http://blog.game18.net/tag/qian-li-ma/">千里码</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p><strong>霍夫曼编码</strong>的概念可以参考<a href="https://zh.wikipedia.org/wiki/%E9%9C%8D%E5%A4%AB%E6%9B%BC%E7%BC%96%E7%A0%81">wiki</a>，道理很容易理解。Easier said than done，还是自己敲一遍比较好。</p>
<h2>1. 分析字符频率</h2>
<p>构建霍夫曼树首先需要分析文本中字符的出现频率，出现频率越高的字符编码越短，这样才能最大程度上压缩长度。频率分析的代码很简单：</p>
<div class="highlight"><pre><span class="c">#分析字符频率</span>
<span class="k">def</span> <span class="nf">freqanalysis</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="n">resultd</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">resultd</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">resultd</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">resultd</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
    <span class="c">#由于字典不支持sort，故转换为tuple的list</span>
    <span class="n">resultl</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">resultd</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">resultl</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">c</span><span class="p">,</span><span class="n">resultd</span><span class="p">[</span><span class="n">c</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">resultl</span>
</pre></div>


<h2>2. 生成霍夫曼树</h2>
<p>树的存储采用链表形式，节点代码如下：</p>
<div class="highlight"><pre><span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">char</span><span class="p">,</span><span class="n">freq</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">father</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">char</span><span class="o">=</span><span class="n">char</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="o">=</span><span class="n">freq</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="o">=</span><span class="n">left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="o">=</span><span class="n">right</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">father</span><span class="o">=</span><span class="n">father</span>
</pre></div>


<p>然后根据频率列表生成霍夫曼树，生成流程：</p>
<ol>
<li>将频率列表转换为节点列表</li>
<li>按照出现频率对节点列表排序</li>
<li>在节点列表中去掉频率最小的两个节点，将这两个节点作为左右子节点合成一个新节点，新节点的频率为两个子节点之和，将新节点添加进节点列表</li>
<li>重复2、3步骤，直至频率列表中剩下一个节点</li>
</ol>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">makehuftree</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
    <span class="n">nodelist</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">nodelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodelist</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">nodelist</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">item</span><span class="p">:</span><span class="n">item</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span>
        <span class="n">leftnode</span><span class="o">=</span><span class="n">nodelist</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">rightnode</span><span class="o">=</span><span class="n">nodelist</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">fathernode</span><span class="o">=</span><span class="n">Node</span><span class="p">(</span><span class="n">leftnode</span><span class="o">.</span><span class="n">char</span><span class="o">+</span><span class="n">rightnode</span><span class="o">.</span><span class="n">char</span><span class="p">,</span><span class="n">leftnode</span><span class="o">.</span><span class="n">freq</span><span class="o">+</span><span class="n">rightnode</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span><span class="n">leftnode</span><span class="p">,</span><span class="n">rightnode</span><span class="p">)</span>
        <span class="n">leftnode</span><span class="o">.</span><span class="n">father</span><span class="o">=</span><span class="n">fathernode</span>
        <span class="n">rightnode</span><span class="o">.</span><span class="n">father</span><span class="o">=</span><span class="n">fathernode</span>
        <span class="n">nodelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fathernode</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nodelist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>


<h2>3. 编码</h2>
<p>根据霍夫曼树即可得到字符与编码的对应关系，方法是：找到从根节点到字符的路径，在从根节点向下移动的过程中，每次经过左子树加一个‘0’，每次经过右子树加一个‘1’，即可得到该字符的编码。</p>
<p>以下是找单个字符编码的代码：</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">huffmanEncode</span><span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="n">tree</span><span class="p">):</span>
    <span class="n">code</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="k">while</span> <span class="n">tree</span><span class="o">.</span><span class="n">left</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">char</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="s">&#39;0&#39;</span>
            <span class="n">tree</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">left</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="s">&#39;1&#39;</span>
            <span class="n">tree</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">right</span>
    <span class="k">return</span> <span class="n">code</span>
</pre></div>


<p>为了方便起见，使用字典存储所有字符的编码：</p>
<div class="highlight"><pre><span class="n">codes</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c">#这里输入的tuplelist即是字符频率列表</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">tuplelist</span><span class="p">:</span>
    <span class="n">codes</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="n">huffmanEncode</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tree</span><span class="p">)</span>
</pre></div>


<p>然后查字典完成文本的编码：</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="n">char</span><span class="p">,</span><span class="n">codes</span><span class="p">):</span>
    <span class="n">result</span><span class="o">=</span><span class="s">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">char</span><span class="p">:</span>
        <span class="n">result</span><span class="o">+=</span><span class="n">codes</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>


<h2>4. 解码</h2>
<p>解码只需要用到霍夫曼树即可，从编码后的字符串中按位读取，从根节点开始，遇到‘0’走左子树，遇到‘1’走右子树，直到走到最终的叶子节点即得到对应的字符，然后回到根节点，重复上述步骤。</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="n">code</span><span class="p">,</span><span class="n">tree</span><span class="p">):</span>
    <span class="n">currentnode</span><span class="o">=</span><span class="n">tree</span>
    <span class="n">s</span><span class="o">=</span><span class="s">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">code</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span><span class="o">==</span><span class="s">&#39;0&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">currentnode</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">left</span><span class="p">:</span>
                <span class="n">currentnode</span><span class="o">=</span><span class="n">currentnode</span><span class="o">.</span><span class="n">left</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span><span class="o">+=</span><span class="n">currentnode</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">char</span>
                <span class="n">currentnode</span><span class="o">=</span><span class="n">tree</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">currentnode</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">right</span><span class="p">:</span>
                <span class="n">currentnode</span><span class="o">=</span><span class="n">currentnode</span><span class="o">.</span><span class="n">right</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span><span class="o">+=</span><span class="n">currentnode</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">char</span>
                <span class="n">currentnode</span><span class="o">=</span><span class="n">tree</span>
    <span class="k">return</span> <span class="n">s</span>
</pre></div>


<p>注意这里探测了下面两层节点，因为到最终节点之前的一个码不仅完成了子树选择，而且应该马上输出子节点的字符。如果只探测一层的话每次输出字符时会“吞掉”一个代码。</p>
<h2>5. 组合起来，测试一下</h2>
<p>选取的文本：</p>
<blockquote>
<p>In 1951, David A. Huffman and his MIT information theory classmates were given the choice of a term paper or a final exam. The professor, Robert M. Fano, assigned a term paper on the problem of finding the most efficient binary code. Huffman, unable to prove any codes were the most efficient, was about to give up and start studying for the final when he hit upon the idea of using a frequency-sorted binary tree and quickly proved this method the most efficient.</p>
</blockquote>
<p>频率分析：</p>
<div class="highlight"><pre><span class="p">[(</span><span class="s">&#39; &#39;</span><span class="p">,</span> <span class="mi">82</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;-&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;5&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;9&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;D&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;F&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;I&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;H&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;M&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;R&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="mi">46</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;h&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;m&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;l&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;o&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;q&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;s&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;w&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;v&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
</pre></div>


<p>对应编码：</p>
<div class="highlight"><pre><span class="p">{</span><span class="s">&#39; &#39;</span><span class="p">:</span> <span class="s">&#39;111&#39;</span><span class="p">,</span> <span class="s">&#39;-&#39;</span><span class="p">:</span> <span class="s">&#39;110000110&#39;</span><span class="p">,</span> <span class="s">&#39;,&#39;</span><span class="p">:</span> <span class="s">&#39;1100011&#39;</span><span class="p">,</span> <span class="s">&#39;.&#39;</span><span class="p">:</span> <span class="s">&#39;000010&#39;</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">:</span> <span class="s">&#39;01000011&#39;</span><span class="p">,</span> <span class="s">&#39;5&#39;</span><span class="p">:</span> <span class="s">&#39;110000111&#39;</span><span class="p">,</span> <span class="s">&#39;9&#39;</span><span class="p">:</span> <span class="s">&#39;110001000&#39;</span><span class="p">,</span> <span class="s">&#39;A&#39;</span><span class="p">:</span> <span class="s">&#39;110001001&#39;</span><span class="p">,</span> <span class="s">&#39;D&#39;</span><span class="p">:</span> <span class="s">&#39;110001010&#39;</span><span class="p">,</span> <span class="s">&#39;F&#39;</span><span class="p">:</span> <span class="s">&#39;110001011&#39;</span><span class="p">,</span> <span class="s">&#39;I&#39;</span><span class="p">:</span> <span class="s">&#39;10110110&#39;</span><span class="p">,</span> <span class="s">&#39;H&#39;</span><span class="p">:</span> <span class="s">&#39;10110111&#39;</span><span class="p">,</span> <span class="s">&#39;M&#39;</span><span class="p">:</span> <span class="s">&#39;11000000&#39;</span><span class="p">,</span> <span class="s">&#39;R&#39;</span><span class="p">:</span> <span class="s">&#39;01000000&#39;</span><span class="p">,</span> <span class="s">&#39;T&#39;</span><span class="p">:</span> <span class="s">&#39;11000001&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="s">&#39;0111&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">:</span> <span class="s">&#39;110110&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="s">&#39;010001&#39;</span><span class="p">,</span> <span class="s">&#39;e&#39;</span><span class="p">:</span> <span class="s">&#39;001&#39;</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">:</span> <span class="s">&#39;01011&#39;</span><span class="p">,</span> <span class="s">&#39;g&#39;</span><span class="p">:</span> <span class="s">&#39;010100&#39;</span><span class="p">,</span> <span class="s">&#39;f&#39;</span><span class="p">:</span> <span class="s">&#39;11010&#39;</span><span class="p">,</span> <span class="s">&#39;i&#39;</span><span class="p">:</span> <span class="s">&#39;0110&#39;</span><span class="p">,</span> <span class="s">&#39;h&#39;</span><span class="p">:</span> <span class="s">&#39;10111&#39;</span><span class="p">,</span> <span class="s">&#39;k&#39;</span><span class="p">:</span> <span class="s">&#39;01000001&#39;</span><span class="p">,</span> <span class="s">&#39;m&#39;</span><span class="p">:</span> <span class="s">&#39;01001&#39;</span><span class="p">,</span> <span class="s">&#39;l&#39;</span><span class="p">:</span> <span class="s">&#39;010101&#39;</span><span class="p">,</span> <span class="s">&#39;o&#39;</span><span class="p">:</span> <span class="s">&#39;1000&#39;</span><span class="p">,</span> <span class="s">&#39;n&#39;</span><span class="p">:</span> <span class="s">&#39;1001&#39;</span><span class="p">,</span> <span class="s">&#39;q&#39;</span><span class="p">:</span> <span class="s">&#39;11000010&#39;</span><span class="p">,</span> <span class="s">&#39;p&#39;</span><span class="p">:</span> <span class="s">&#39;110111&#39;</span><span class="p">,</span> <span class="s">&#39;s&#39;</span><span class="p">:</span> <span class="s">&#39;11001&#39;</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">:</span> <span class="s">&#39;0001&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">:</span> <span class="s">&#39;00000&#39;</span><span class="p">,</span> <span class="s">&#39;t&#39;</span><span class="p">:</span> <span class="s">&#39;1010&#39;</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">:</span> <span class="s">&#39;1011010&#39;</span><span class="p">,</span> <span class="s">&#39;v&#39;</span><span class="p">:</span> <span class="s">&#39;000011&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">:</span> <span class="s">&#39;101100&#39;</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">:</span> <span class="s">&#39;01000010&#39;</span><span class="p">}</span>
</pre></div>


<p>编码：</p>
<div class="highlight"><pre><span class="mi">1011011010011110100001111000100011000011101000011110001111111000101001110000110110010111111100010010000101111011011100000110101101001001011110011110111100101011111101110110110011111100000010110110110000011110110100111010100000010100101111010011010001001111101010111001100000011011001111101100101010111110011100101001011110100011100111110110100010001001111010100011000001100110011111010101110011111101101011110000110110110001111100011010111011111110100010001010011111101110111110111001000111110000001111011111111010011010010111010101111001010000100111010010000101111100000110111001111110111000110001101000111001110011000000111000111110100000010000100010010001101011111000000000010111110001011011110011000110001111101111100111001011001010010010010101111101111111010001000101001111110111011111011100100011111000100111110101011100111111011100011000010001010101001010011111000110101111101001101001010110110100101010011110101011100111101001100011001101011100111010110100110110110011000110011010111010001011010010111000110110011111011010000101100100001011110110111000001101011010010010111100111000111110000010010111010001010101001111101010001111101110001100000001100111101111001101100111110110100001011001110011111011010001000100111110101011100111101001100011001101011100111010110100110110110011000110011010110001111110110100111110011110111010001100000000101011110101000111010100011000001100111100000110111111011110010101111111001101001110001101011111001101000000010111011000110100101010011111010100000011111010101110011111101001101001011101010111110110101011100110011111011100111110111011010101110000011011110001001111101010111001111011001011001011111110001101011100000110010110100101010011101111111101000010011100001000000001100111011010110011000011011001100000011010001010111110100010110100101110001101100111101000010010011110111100101011111110000100000001101101100100000101010110110011111011100011000000011001010111111010101110110110011110100100110101011110000101111110101011100111101001100011001101011100111010110100110110110011000110011010000010</span>
</pre></div>


<h2>6.唯一性问题</h2>
<p>从霍夫曼树的生成方式来看，生成结果并不唯一。维基上的示例中就采取了一种不太规范的操作：在将('R',4),('G',4)合并之后频率为8，如果此时做排序的话应该在('T',7)的右边，而示例中并没有这么做，这就导致左右子树最终编码的第二位对调。</p>
<p>即便严格进行频率排序，频率相同的子树也可以调换位置，从而导致最终编码不同。回到<a href="http://www.qlcoder.com/task/7680">千里码的问题</a>中来，按照上述代码解码出来还是乱码，就是由于出题人使用了不同的树编码。这就引申出一个问题：如何遍历所有可能的霍夫曼树？</p>
<p>在只调换频率相同的子树的原则下，我想了一个解决方法：</p>
<ol>
<li>遍历所有节点，找出频率相同的节点列表，按照频率分组。假如频率为1的有3个，频率为3的有2个节点。</li>
<li>找出上述节点所有可能的排列，同频率的按分组取排列，然后与别的分组叠加。对于上面的情况，有3*2*2=12种排列方式。</li>
<li>将原树中的节点的父节点改为每种排列中的对应节点的父节点</li>
<li>使用新生成的树解码</li>
</ol>
<p>输出所有可能性后人肉应该就能找到需要的结果。（还没有实际测试，之后再补结果吧）</p>
            </div>
            <!-- /.entry-content -->
<section class="well" id="related-posts">
    <h4>Related Posts:</h4>
    <ul>
        <li><a href="http://blog.game18.net/posts/2016/05/cheng-xu-yuan-de-zi-wo-xiu-yang/">程序员的自我修养</a></li>
    </ul>
</section>
    <hr />
    <!-- Shariff Button BEGIN -->
    <div class="shariff"
        data-lang="en"
        data-orientation=""
        data-services = "[&quot;twitter&quot;,&quot;facebook&quot;,&quot;googleplus&quot;]"
        data-theme="grey"
        data-twitter-via="ROCLEE"
        data-url="http://blog.game18.net/posts/2016/05/huo-fu-man-bian-ma/"></div>
    <!-- Shariff Button END -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'rocmaxscats'; // required: replace example with your forum shortname

                    var disqus_identifier = 'huo-fu-man-bian-ma';
                var disqus_url = 'http://blog.game18.net/posts/2016/05/huo-fu-man-bian-ma/';

            var disqus_config = function () {
                this.language = "zh";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<div id="aboutme">
        <p>
            <img width="100%" class="img-thumbnail" src="/extra/avatar.png"/>
        </p>
    <p>
        <strong>About Roc</strong><br/>
        <p>A Mobile Game Developer.</p>            <p>Indie Game : <a style="color: #0066FF" href="https://play.google.com/store/apps/details?id=jp.co.newchar.noteball">NoteBall</a></p>            <p>Using Cocos2d-x Unity3D</p>
    </p>
</div>
<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="https://github.com/RocMax"><i class="fa fa-github-square fa-lg"></i> GitHub</a></li>
                <li class="list-group-item"><a href="https://twitter.com/ROCLEE"><i class="fa fa-twitter-square fa-lg"></i> Twitter</a></li>
                <li class="list-group-item"><a href="feed/all.atom.xml"><i class="fa fa-rss-square fa-lg"></i> Rss</a></li>
              </ul>
            </li>


            <li class="list-group-item"><a href="http://blog.game18.net/"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Categories</span></h4></a>
                <ul class="list-group" id="categories">
                    <li class="list-group-item">
                        <a href="http://blog.game18.net/category/cocos2d-x">
                            <i class="fa fa-folder-open fa-lg"></i> Cocos2d-x
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="http://blog.game18.net/category/python">
                            <i class="fa fa-folder-open fa-lg"></i> Python
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="http://blog.game18.net/category/sui-bi">
                            <i class="fa fa-folder-open fa-lg"></i> 随笔
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="http://blog.game18.net/category/wang-ye-ji-zhu">
                            <i class="fa fa-folder-open fa-lg"></i> 网页技术
                        </a>
                    </li>
                </ul>
            </li>

            <li class="list-group-item"><a href="http://blog.game18.net/tags.html"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                <ul class="list-group list-inline tagcloud" id="tags">
                    <li class="list-group-item tag-2">
                        <a href="http://blog.game18.net/tag/android/">
                            Android
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.game18.net/tag/apache/">
                            apache
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.game18.net/tag/baidu/">
                            Baidu
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.game18.net/tag/beautifulsoup/">
                            BeautifulSoup
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.game18.net/tag/box2d/">
                            Box2D
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://blog.game18.net/tag/c/">
                            C++
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.game18.net/tag/centos/">
                            CentOS
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://blog.game18.net/tag/cocos2d-x/">
                            Cocos2d-x
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.game18.net/tag/crawl/">
                            crawl
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.game18.net/tag/cyanogenmod/">
                            CyanogenMod
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://blog.game18.net/tag/firehdx/">
                            FireHDX
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.game18.net/tag/gaussian-blur/">
                            Gaussian Blur
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://blog.game18.net/tag/github/">
                            Github
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.game18.net/tag/html/">
                            html
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.game18.net/tag/huffman/">
                            Huffman
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.game18.net/tag/liquid-simulation/">
                            Liquid Simulation
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://blog.game18.net/tag/markdown/">
                            MarkDown
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://blog.game18.net/tag/pelican/">
                            Pelican
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://blog.game18.net/tag/python/">
                            Python
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://blog.game18.net/tag/qian-li-ma/">
                            千里码
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.game18.net/tag/rendertexture/">
                            RenderTexture
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://blog.game18.net/tag/root/">
                            ROOT
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.game18.net/tag/safestrap/">
                            Safestrap
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.game18.net/tag/shader/">
                            Shader
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.game18.net/tag/vsftpd/">
                            vsftpd
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://blog.game18.net/tag/wu-li-yin-qing/">
                            物理引擎
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://blog.game18.net/tag/xin-qing/">
                            心情
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.game18.net/tag/you-xi-gan-xiang/">
                            游戏感想
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.game18.net/tag/you-xi-kai-fa/">
                            游戏开发
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.game18.net/tag/yy-bord/">
                            yy-bord
                        </a>
                    </li>
                </ul>
            </li>
    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://python.org/" target="_blank">
                Python.org
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://cocos.com/" target="_blank">
                Cocos2d-x
            </a>
        </li>
      </ul>
    </li>
    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2016 Roc
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>              <p><small>  <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a>
    Content
  licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution 4.0 International License</a>, except where indicated otherwise.
</small></p>
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://blog.game18.net/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://blog.game18.net/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://blog.game18.net/theme/js/respond.min.js"></script>

    <script src="http://blog.game18.net/theme/js/bodypadding.js"></script>
    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'rocmaxscats'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-68564285-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->

    <!-- add shariff support -->
    <script src="http://blog.game18.net/theme/js/shariff.min.js"></script>
</body>
</html>